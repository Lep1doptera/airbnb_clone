
<% if user_signed_in?%>
<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-6 text-center">
      <h2>Your Dashboard</h2>
    </div>
  </div>

  <div class="row g-4 justify-content-center mt-3">
    <%# Render properties owned by current_user %>
    <div class="col-md-4">
      <div class="bg-light p-4 shadow-sm rounded">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h4 class="mb-0">My Properties</h4>
          <%= link_to "Add new Property", new_property_path, class: "btn btn-outline-primary" %>
        </div>
        <% if current_user.properties.any? %>
          <%= render "index_shared", locals: { properties: current_user.properties } %>
        <% else %>
          <p>No properties</p>
        <% end %>
      </div>
    </div>

    <%# Other partials %>
    <div class="col-md-4">
      <div class="bg-light p-4 shadow-sm rounded">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h4 class="mb-0">My bookings</h4>
        </div>
          <%# Render partial here %>
          <p>partial goes here</p>
      </div>
    </div>

     <%# Other partials %>
    <div class="col-md-4">
      <div class="bg-light p-4 shadow-sm rounded">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h4 class="mb-0">Booking requests</h4>
        </div>
          <%# Render partial here %>
          <p>partial goes here</p>
      </div>
    </div>



  </div>
</div>

<%# NOT SIGNED IN %>
<% else %>

<div class="m-4">
  <h1> Welcome to Airbnb </h1>
</div>
  <div class="container mt-5">
    <div class="row ">
      <% @random_properties.each do |property| %>
        <div class="col-md-6 col-lg-3 mb-4">
          <%= link_to property_path(property) do %>
          <div class="card h-100">
            <img src="<%= property.property_image_url %>" class="card-img-top img-fluid rounded-top" alt="Property image">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title"><%= property.property_address %></h5>
              <p class="card-text flex-grow-1"><%= property.description %></p>
            </div>
          </div>
          <%end%>
        </div>
      <% end %>
  </div>

  <div class="text-center mt-4">
    <%= link_to "Check Out More Properties", properties_path, class: "btn btn-primary" %>
  </div>
</div>
<% end %>

<% if user_signed_in? %>

  <h5>My House Bookings</h5>
    <% @bookings.each do |booking| %>
      <% if booking.property.user_id == current_user.id %>
        <div data-controller="booking" data-booking-id="<%= booking.id %>">
          <p>
            <%= booking.property.property_address %> |
            <%= booking.user_id %> |
            <%= booking.check_in_date %> -
            <%= booking.check_out_date %> |
            Status: <span data-booking-target="status"><%= booking.booking_status %></span>
          </p>
          <select data-action="change->booking#updateStatus" data-booking-target="select">
            <option value="" disabled <%= "selected" if booking.booking_status.blank? %>>Choose status</option>
            <option value="pending" <%= "selected" if booking.booking_status == "pending" %>>Pending</option>
            <option value="confirmed" <%= "selected" if booking.booking_status == "confirmed" %>>Confirmed</option>
          </select>
        </div>
      <% end %>
    <% end %>



<%end%>
